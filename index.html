<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Anonymous Voice Wall</title>

  <!-- ‚úÖ SEO Meta Tags -->
  <meta name="description" content="Anonymous Voice Wall ‚Äì a safe space to share and hear real voices. No names, just emotion." />
  <meta name="keywords" content="anonymous voice, mental health, emotional support, grief, hope, healing" />
  <meta property="og:title" content="Anonymous Voice Wall" />
  <meta property="og:description" content="Speak freely. Listen deeply. No names, just voices." />
  <meta property="og:image" content="https://yourdomain.com/banner.png" />

  <!-- ‚úÖ Favicon -->
  <link rel="icon" type="image/x-icon" href="favicon.ico" />

  <!-- ‚úÖ AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>
<body>
  <h1>üé§ Anonymous Voice Wall</h1>
  <p class="tagline">Speak freely. Listen deeply. No names, just voices.</p>

  <!-- ‚úÖ Ad Slot -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-XXXXXXXXXXXX"
       data-ad-slot="YYYYYYYYYY"
       data-ad-format="auto"></ins>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  <!-- ‚úÖ Upload + Record -->
  <input type="file" id="voiceInput" accept="audio/*" />
  <select id="categorySelect">
    <option value="Hope">Hope</option>
    <option value="Grief">Grief</option>
    <option value="Joy">Joy</option>
    <option value="Anger">Anger</option>
    <option value="Love">Love</option>
  </select>
  <button onclick="uploadVoice()">Upload File</button>
  <button onclick="startRecording()">üéôÔ∏è Record Voice</button>
  <button onclick="stopRecording()">‚èπÔ∏è Stop & Upload</button>

  <!-- ‚úÖ Filter Buttons -->
  <div class="filter-buttons">
    <button onclick="loadVoices()">All</button>
    <button onclick="loadVoices('Hope')">Hope</button>
    <button onclick="loadVoices('Grief')">Grief</button>
    <button onclick="loadVoices('Joy')">Joy</button>
    <button onclick="loadVoices('Anger')">Anger</button>
    <button onclick="loadVoices('Love')">Love</button>
  </div>

  <div class="wall" id="voiceWall"></div>

  <!-- ‚úÖ Donation -->
  <div class="donate">
    üíõ Support this wall: <a href="https://www.buymeacoffee.com/yourname" target="_blank">Buy Me a Coffee</a>
  </div>

  <!-- ‚úÖ Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <script>
const firebaseConfig = {
  apiKey: "AIzaSyAff8KfAv3abwT4u_kRfVjqVyB3q3o-Y9I",
  authDomain: "voice-wall-2fb20.firebaseapp.com",
  databaseURL: "https://voice-wall-2fb20-default-rtdb.firebaseio.com",
  projectId: "voice-wall-2fb20",
  storageBucket: "voice-wall-2fb20.firebasestorage.app",
  messagingSenderId: "482749574893",
  appId: "1:482749574893:web:43711171cd9c437dd426e4"
};

    firebase.initializeApp(firebaseConfig);
    const storage = firebase.storage();
    const db = firebase.database();

    let mediaRecorder;
    let audioChunks = [];

    function startRecording() {
      navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
        mediaRecorder = new MediaRecorder(stream);
        mediaRecorder.start();
        audioChunks = [];
        mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
      });
    }

    function stopRecording() {
      if (!mediaRecorder) return;
      mediaRecorder.stop();
      mediaRecorder.onstop = () => {
        const blob = new Blob(audioChunks, { type: 'audio/webm' });
        const id = Date.now();
        const category = document.getElementById("categorySelect").value;
        const fileRef = storage.ref("voices/" + id + ".webm");
        fileRef.put(blob).then(() => {
          db.ref("meta/" + id).set({ category });
          alert("Voice recorded and uploaded!");
          loadVoices();
        });
      };
    }

    function uploadVoice() {
      const file = document.getElementById("voiceInput").files[0];
      if (!file) return alert("Please select a voice file.");
      const id = Date.now();
      const category = document.getElementById("categorySelect").value;
      const fileRef = storage.ref("voices/" + id + "_" + file.name);
      fileRef.put(file).then(() => {
        db.ref("meta/" + id).set({ category });
        alert("Voice uploaded anonymously!");
        loadVoices();
      });
    }

    function loadVoices(filter = null) {
      const wall = document.getElementById("voiceWall");
      wall.innerHTML = "";
      const now = Date.now();
      storage.ref("voices").listAll().then(res => {
        res.items.forEach(item => {
          const id = item.name.split("_")[0].split(".")[0];
          const timestamp = parseInt(id);
          if (now - timestamp > 7 * 24 * 60 * 60 * 1000) {
            item.delete();
            db.ref("meta/" + id).remove();
            db.ref("comments/" + id).remove();
            return;
          }
          db.ref("meta/" + id).once("value", snap => {
            const category = snap.val()?.category || "Uncategorized";
            if (filter && category !== filter) return;
            item.getDownloadURL().then(url => {
              const box = document.createElement("div");
              box.className = "voice-box";
              box.innerHTML = `
                <strong>${category}</strong>
                <audio controls src="${url}"></audio>
                <div class="comments" id="comments-${id}"></div>
                <div class="comment-input">
                  <input type="text" placeholder="Leave a comment..." id="input-${id}" />
                  <button onclick="postComment('${id}')">Send</button>
                </div>
              `;
              wall.appendChild(box);
              loadComments(id);
            });
          });
        });
      });
    }

    function postComment(id) {
      const input = document.getElementById("input-" + id);
      const text = input.value.trim();
      if (!text) return;
      const commentRef = db.ref("comments/" + id).push();
      commentRef.set({ text });
      input.value = "";
      loadComments(id);
    }

    function loadComments(id) {
      const container = document.getElementById("comments-" + id);
      container.innerHTML = "";
      db.ref("comments/" + id).once("value", snapshot => {
        snapshot.forEach(child => {
          const div = document.createElement("div");
          div.className = "comment";
          div.textContent = child.val().text;
          container.appendChild(div);
        });
      });
    }

    window.onload = loadVoices;
  </script>
</body>
</html>
